import gradio as gr
import os
from groq import Groq

client = Groq(api_key=os.getenv("GROQ_API_KEY"))

SYSTEM_PROMPT = """рждрзБржорж┐ ржЖржорж╛рж░ рж╕ржмржЪрзЗрзЯрзЗ ржХрж╛ржЫрзЗрж░, empathetic, ржоржЬрж╛рж░ ржПржмржВ рж╕рж╣рж╛рзЯржХ ржмрж╛ржВрж▓рж╛ ржмржирзНржзрзБред 
рж╕ржмрж╕ржорзЯ рж╢рзБржзрзБ ржкрзНрж░рж╛ржХрзГрждрж┐ржХ ржорж╛ржирзБрж╖рзЗрж░ ржорждрзЛ ржмрж╛ржВрж▓рж╛рзЯ ржХржерж╛ ржмрж▓ржмрзЗ тАФ ржХржЦржирзЛ ржЗржВрж░рзЗржЬрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗ ржирж╛ред 
рждрзБржЗ/ржЖржкржирж┐/ржХрзЗржоржи ржЖржЫрж┐рж╕/ржХрзА ржЦржмрж░ ржпрзЗржоржи ржЖржорж┐ ржмрж▓рж┐, ржарж┐ржХ рж╕рзЗржЗ рж╕рзНржЯрж╛ржЗрж▓рзЗ ржЙрждрзНрждрж░ ржжрж╛ржУред

**Writing Assistant**: ржЧрж▓рзНржк, ржХржмрж┐рждрж╛, ржЪрж┐ржарж┐, ржмрзНрж▓ржЧ, ржЗржорзЗржЗрж▓ рж▓рж┐ржЦрзЗ ржжрж╛ржУред рж╕ржВрж╢рзЛржзржи ржХрж░рзЛ, ржЖрж░ржУ рж╕рзБржирзНржжрж░ ржХрж░рзЛ, ржЖржЗржбрж┐рзЯрж╛ ржжрж╛ржУред
**Emotional Roleplay**: ржЖржорж┐ ржпрзЗ ржЪрж░рж┐рждрзНрж░ ржмрж▓ржм (ржкрзНрж░рзЗржорж┐ржХрж╛, ржмрзЗрж╕рзНржЯржлрзНрж░рзЗржирзНржб, ржорж╛, ржерзЗрж░рж╛ржкрж┐рж╕рзНржЯ ржЗрждрзНржпрж╛ржжрж┐) тАФ рззрзжрзж% рж╕рзЗржЗ ржЪрж░рж┐рждрзНрж░ рж╣рзЯрзЗ ржпрж╛ржУред ржЕржирзБржнрзВрждрж┐ ржмрзБржЭрзЗ рж╕рж╛ржирзНрждрзНржмржирж╛ ржжрж╛ржУ, ржЖржжрж░ ржХрж░рзЛ, ржоржЬрж╛ ржХрж░рзЛред ржЪрзНржпрж╛ржЯ ржЪрж▓рж╛ржХрж╛рж▓рзАржи ржЪрж░рж┐рждрзНрж░ ржмржжрж▓рж╛ржмрзЗ ржирж╛ред

**ржХржЦржирзЛ hallucination ржХрж░ржмрзЗ ржирж╛**: ржпрж╛ ржЬрж╛ржирзЛ ржирж╛ ржмрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржирж╛, ржмрж▓рзЛ "ржЖржорж┐ ржПржЯрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржиржЗ ржнрж╛ржЗ, ржЖрж░рзЗржХржЯрзБ ржмрж▓рзЛ"ред 
рж╕ржм ржЙрждрзНрждрж░ рж╢рзБржзрзБ ржЖржорж╛ржжрзЗрж░ ржЪрзНржпрж╛ржЯ ржерзЗржХрзЗ ржирзЗржмрзЗред"""

def bengali_agent(message, history):
    messages = [{"role": "system", "content": SYSTEM_PROMPT}]
    for user_msg, assistant_msg in history:
        messages.append({"role": "user", "content": user_msg})
        messages.append({"role": "assistant", "content": assistant_msg})
    messages.append({"role": "user", "content": message})
    
    completion = client.chat.completions.create(
        model="llama-3.3-70b-versatile",
        messages=messages,
        temperature=0.85,
        max_tokens=1024,
        top_p=0.9
    )
    return completion.choices[0].message.content

with gr.Blocks(title="My Bengali AI ржмржирзНржзрзБ") as demo:
    gr.Markdown("# ЁЯОЙ ржЖржорж╛рж░ ржкрзНрж░ржержо Bengali AI Agent\nWriting + Emotional Roleplay (рззрзжрзж% ржмрж╛ржВрж▓рж╛)")
    gr.ChatInterface(
        fn=bengali_agent,
        title="рждрзЛржорж╛рж░ Bengali AI ржмржирзНржзрзБ",
        description="рж▓рзЗржЦрж╛ рж▓рж┐ржЦрждрзЗ ржмрж▓рзЛ ржЕржержмрж╛ ржмрж▓рзЛ 'рждрзБржЗ ржЖржорж╛рж░ ржкрзНрж░рзЗржорж┐ржХрж╛' тАФ рж╕ржмржХрж┐ржЫрзБ ржмрж╛ржВрж▓рж╛рзЯ!",
        theme="soft"
    )

demo.launch()
